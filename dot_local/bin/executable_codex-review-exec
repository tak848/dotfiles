#!/bin/bash
set -euo pipefail

# codex exec ラッパー: プロンプトファイルを受け取り、mktemp で一意な出力ファイルを作成して codex exec に渡す
# Usage:
#   codex-review-exec <prompt-file>
#   codex-review-exec <prompt-file> resume <THREAD_ID>

PROMPT_FILE="$1"
shift
TMPFILE=$(mktemp /tmp/codex-review.XXXXXXXXXX)
trap 'echo "OUTPUT_FILE=$TMPFILE"' EXIT
codex exec --json --full-auto -o "$TMPFILE" "$@" - < "$PROMPT_FILE"
